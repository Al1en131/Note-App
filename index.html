<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Catatan Aplikasi</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <app-header></app-header>

    <note-form></note-form>

    <h2>Daftar Catatan</h2>
    <notes-list></notes-list>

    <script>
      class AppHeader extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
        }

        connectedCallback() {
          this.shadowRoot.innerHTML = `
                <style>
                    :host {
                        display: block;
                        background-color: #4A90E2;
                        color: white;
                        padding: 20px;
                        text-align: center;
                        font-weight: 700;
                        font-size: 24px;
                    }
                </style>
                <div>Catatan Aplikasi</div>
            `;
        }
      }

      customElements.define("app-header", AppHeader);

      class NoteItem extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
        }

        connectedCallback() {
          const title = this.getAttribute("title");
          const body = this.getAttribute("body");
          const date = this.getAttribute("date");

          this.shadowRoot.innerHTML = `
                <style>
                    :host {
                        display: block;
                        background-color: #fff;
                        border: 1px solid #ddd;
                        border-radius: 8px;
                        padding: 15px;
                        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                    }

                    h3 {
                        color: #4A90E2;
                        margin: 0 0 10px 0;
                    }

                    p {
                        color: #666;
                        font-size: 14px;
                    }

                    small {
                        color: #aaa;
                        font-size: 12px;
                    }
                </style>

                <h3>${title}</h3>
                <p>${body}</p>
                <small>${new Date(date).toLocaleDateString()}</small>
            `;
        }
      }

      customElements.define("note-item", NoteItem);

      class NoteForm extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
        }

        connectedCallback() {
          this.shadowRoot.innerHTML = `
                <style>
                    :host {
                        display: block;
                        margin: 20px auto;
                        width: 100%;
                        padding: 20px;
                        max-width: 600px;
                    }

                    input, textarea {
                        width: 95%;
                        padding: 10px;
                        margin-bottom: 10px;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        font-family: "Poppins", sans-serif;
                    }

                    button {
                        padding: 10px 15px;
                        background-color: #4A90E2;
                        color: white;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                        font-size: 16px;
                    }

                    button:hover {
                        background-color: #357ABD;
                    }
                </style>
                <form id="note-form">
                    <input type="text" id="note-title" placeholder="Judul Catatan" required />
                    <div id="title-error" class="error"></div>
                    <textarea id="note-body" placeholder="Isi Catatan" required></textarea>
                    <div id="body-error" class="error"></div>
                    <button type="submit" disabled>Tambah Catatan</button>
                </form>
            `;

          const form = this.shadowRoot.querySelector("#note-form");
          const titleInput = this.shadowRoot.querySelector("#note-title");
          const bodyInput = this.shadowRoot.querySelector("#note-body");
          const submitButton = this.shadowRoot.querySelector("button");

          titleInput.addEventListener("input", () =>
            this.validateTitle(titleInput)
          );
          bodyInput.addEventListener("input", () =>
            this.validateBody(bodyInput)
          );

          form.addEventListener("submit", (event) => {
            event.preventDefault();
            this.addNote();
          });

          const validateForm = () => {
            if (this.isValidForm()) {
              submitButton.disabled = false;
            } else {
              submitButton.disabled = true;
            }
          };

          titleInput.addEventListener("input", validateForm);
          bodyInput.addEventListener("input", validateForm);
        }

        validateTitle(input) {
          const errorMessage = this.shadowRoot.querySelector("#title-error");
          if (input.value.trim() === "") {
            errorMessage.textContent = "Judul catatan tidak boleh kosong";
          } else if (input.value.length > 50) {
            errorMessage.textContent =
              "Judul catatan tidak boleh lebih dari 50 karakter";
          } else {
            errorMessage.textContent = "";
          }
        }

        validateBody(input) {
          const errorMessage = this.shadowRoot.querySelector("#body-error");
          if (input.value.trim() === "") {
            errorMessage.textContent = "Isi catatan tidak boleh kosong";
          } else if (input.value.length < 10) {
            errorMessage.textContent =
              "Isi catatan harus lebih dari 10 karakter";
          } else {
            errorMessage.textContent = "";
          }
        }

        isValidForm() {
          const titleInput = this.shadowRoot.querySelector("#note-title");
          const bodyInput = this.shadowRoot.querySelector("#note-body");
          return (
            titleInput.value.trim() !== "" &&
            titleInput.value.length <= 50 &&
            bodyInput.value.trim() !== "" &&
            bodyInput.value.length >= 10
          );
        }

        addNote() {
          const title = this.shadowRoot.querySelector("#note-title").value;
          const body = this.shadowRoot.querySelector("#note-body").value;

          if (!title || !body) return;

          const note = document.createElement("note-item");
          note.setAttribute("title", title);
          note.setAttribute("body", body);
          note.setAttribute("date", new Date().toISOString());

          const notesList = document.querySelector("notes-list");
          notesList.insertBefore(note, notesList.firstChild);
          this.shadowRoot.querySelector("#note-form").reset();
          this.shadowRoot.querySelector("button").disabled = true;
        }
      }

      customElements.define("note-form", NoteForm);

      const initialNotes = [
        {
          id: "notes-jT-jjsyz61J8XKiI",
          title: "Welcome to Notes, Dimas!",
          body: "Welcome to Notes! This is your first note. You can archive it, delete it, or create new ones.",
          createdAt: "2022-07-28T10:03:12.594Z",
          archived: false,
        },
        {
          id: "notes-aB-cdefg12345",
          title: "Meeting Agenda",
          body: "Discuss project updates and assign tasks for the upcoming week.",
          createdAt: "2022-08-05T15:30:00.000Z",
          archived: false,
        },
        {
          id: "notes-XyZ-789012345",
          title: "Shopping List",
          body: "Milk, eggs, bread, fruits, and vegetables.",
          createdAt: "2022-08-10T08:45:23.120Z",
          archived: false,
        },
        {
          id: "notes-1a-2b3c4d5e6f",
          title: "Personal Goals",
          body: "Read two books per month, exercise three times a week, learn a new language.",
          createdAt: "2022-08-15T18:12:55.789Z",
          archived: false,
        },
        {
          id: "notes-LMN-456789",
          title: "Recipe: Spaghetti Bolognese",
          body: "Ingredients: ground beef, tomatoes, onions, garlic, pasta. Steps:...",
          createdAt: "2022-08-20T12:30:40.200Z",
          archived: false,
        },
        {
          id: "notes-QwErTyUiOp",
          title: "Workout Routine",
          body: "Monday: Cardio, Tuesday: Upper body, Wednesday: Rest, Thursday: Lower body, Friday: Cardio.",
          createdAt: "2022-08-25T09:15:17.890Z",
          archived: false,
        },
        {
          id: "notes-abcdef-987654",
          title: "Book Recommendations",
          body: "1. 'The Alchemist' by Paulo Coelho\n2. '1984' by George Orwell\n3. 'To Kill a Mockingbird' by Harper Lee",
          createdAt: "2022-09-01T14:20:05.321Z",
          archived: false,
        },
        {
          id: "notes-zyxwv-54321",
          title: "Daily Reflections",
          body: "Write down three positive things that happened today and one thing to improve tomorrow.",
          createdAt: "2022-09-07T20:40:30.150Z",
          archived: false,
        },
        {
          id: "notes-poiuyt-987654",
          title: "Travel Bucket List",
          body: "1. Paris, France\n2. Kyoto, Japan\n3. Santorini, Greece\n4. New York City, USA",
          createdAt: "2022-09-15T11:55:44.678Z",
          archived: false,
        },
        {
          id: "notes-asdfgh-123456",
          title: "Coding Projects",
          body: "1. Build a personal website\n2. Create a mobile app\n3. Contribute to an open-source project",
          createdAt: "2022-09-20T17:10:12.987Z",
          archived: false,
        },
        {
          id: "notes-5678-abcd-efgh",
          title: "Project Deadline",
          body: "Complete project tasks by the deadline on October 1st.",
          createdAt: "2022-09-28T14:00:00.000Z",
          archived: false,
        },
        {
          id: "notes-9876-wxyz-1234",
          title: "Health Checkup",
          body: "Schedule a routine health checkup with the doctor.",
          createdAt: "2022-10-05T09:30:45.600Z",
          archived: false,
        },
        {
          id: "notes-qwerty-8765-4321",
          title: "Financial Goals",
          body: "1. Create a monthly budget\n2. Save 20% of income\n3. Invest in a retirement fund.",
          createdAt: "2022-10-12T12:15:30.890Z",
          archived: false,
        },
        {
          id: "notes-98765-54321-12345",
          title: "Holiday Plans",
          body: "Research and plan for the upcoming holiday destination.",
          createdAt: "2022-10-20T16:45:00.000Z",
          archived: false,
        },
        {
          id: "notes-1234-abcd-5678",
          title: "Language Learning",
          body: "Practice Spanish vocabulary for 30 minutes every day.",
          createdAt: "2022-10-28T08:00:20.120Z",
          archived: false,
        },
      ];

      const notesList = document.querySelector("notes-list");
      initialNotes.forEach((note) => {
        const noteElement = document.createElement("note-item");
        noteElement.setAttribute("title", note.title);
        noteElement.setAttribute("body", note.body);
        noteElement.setAttribute("date", note.createdAt);
        notesList.appendChild(noteElement);
      });
    </script>
  </body>
</html>
